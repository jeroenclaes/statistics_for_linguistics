---
title: "Topic 3: Data frames (recap), normal distribution and outliers (recap), and exploring qualitative variables"
author: "Jeroen Claes | <jeroen.claes@kuleuven.be> | <jeroen@cropland.be>"
output: 
 html_document:
  self_contained: false 
---
## 1. Working with data.frames (recap)
### Loading data from CSV
```{r, include=FALSE}
#library(testwhat)
tutorial::go_interactive()
```

```{r ex="create_a", type="sample-code"}
# Load the readr package

# Load the course data from the coutrse website to the object 'dataSet':
# http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv

# Load the dplyr package

# Print a 'glimpse' of the dataSet

```

```{r ex="create_a", type="solution"}
# Load the readr package
library(readr)
# Load the course data from the course website to the object 'dataSet':
# http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
# Load the dplyr package
library(dplyr)
# Print a 'glimpse' of the dataSet
glimpse(dataSet)
```

```{r ex="create_a", type="sct"}
test_object("dataSet")
test_library_function("readr", "Make sure to call the 'readr' package!")
test_library_function("dplyr", "Make sure to call the 'dplyr' package!")
test_output_contains("glimpse(dataSet)",   incorrect_msg = "Make sure to print a 'glimpse' of the data!")
success_msg("Great!")
```

### Subsetting data.frames (1/4)

```{r ex="explore", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv", locale=locale(encoding = "UTF-8"))
```

```{r ex="explore", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Print the first 25 values of its noun column


```

```{r ex="explore", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Print the first 25 values of its noun column
head(dataSet$noun,25)

```

```{r ex="explore", type="sct"}
test_output_contains("head(dataSet$noun, 25)",  incorrect_msg = "Make sure to print the first 25 nouns")
success_msg("Great!")
```

### Subsetting data.frames (2/4)

```{r ex="explore2", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="explore2", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Print the first 6 values of noun that have noun_length equal to 6

```

```{r ex="explore2", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Print the first 6 values of noun that have noun_length equal to 6
head(dataSet[dataSet$noun_length==6,c("noun")])
```

```{r ex="explore2", type="sct"}
test_output_contains('head(dataSet[dataSet$noun_length==6,c("noun")])', incorrect_msg= "Make sure to print the first six rows")
success_msg("Great!")
```

### Subsetting data.frames (3/4)
```{r ex="subset1", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="subset1", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Print the last 20 values 'noun' that have a noun_length smaller than 5

# Create a new data.frame, called shortNouns, which holds all rows and all columns of dataSet, where noun_length is smaller than or equal to 10

# Print the 10th, the thirtieth, and the 100th row of this data.frame


```

```{r ex="subset1", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Print the last 20 values 'noun' that have a noun_length smaller than 5
tail(dataSet[dataSet$noun_length < 5,c("noun")],20)

# Create a new data.frame, called shortNouns, which holds all rows and all columns of dataSet, where noun_length is smaller than or equal to 10
shortNouns <- dataSet[dataSet$noun_length <= 10,]

# Print the first, the second, and the 50th row of this data.frame
shortNouns[c(10, 30, 100),]
```

```{r ex="subset1", type="sct"}

 test_output_contains('tail(dataSet[dataSet$noun_length < 5, c("noun")],20)',  incorrect_msg  = "Make sure to print the last 20 values of noun")
test_object("shortNouns")
test_output_contains("shortNouns[c(10, 30, 100),]",  incorrect_msg = "Make sure to print the first, the second, and the 50th row of lowFrequency")
success_msg("Great!")
```

### Subsetting data.frames (4/4)
```{r ex="subset2", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
library(dplyr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="subset2", type="sample-code"}
# The data.frame dataSet is already in your workspace. 
# The package dplyr is already loaded

# Extract all values of `noun` with noun_length smaller than 5. Print only the first 15 nouns

# Extract the noun_length of the following nouns: "restricciones" "fotos" "olivas"  "periodistas" "cosechadoras" 

# Add a new variable to the data.frame, called meanLength which stores the mean of noun_length

# Print a summary of the modified data.Frame
```

```{r ex="subset2", type="solution"}
# The data.frame dataSet is already in your workspace. 
# The package dplyr is already loaded

# Extract all values of `noun` with noun_length smaller than 5. Print only the first 15 words
head(dataSet[dataSet$noun_length < 5,c("noun")], 15)

# Extract the noun_length of the following nouns: "restricciones" "fotos" "olivas"  "periodistas" "cosechadoras" 
dataSet[dataSet$noun %in% c("restricciones", "fotos", "olivas", "periodistas","cosechadoras"), c("noun_length")]

# Add a new variable to the data.frame, called FreqByTwo which stores the Freq of the word, divided by two
dataSet$meanLength <- mean(dataSet$noun_length, na.rm=TRUE)

# Print a glimpse of the modified data.Frame
glimpse(dataSet)
```

```{r ex="subset2", type="sct"}
test_output_contains('head(dataSet[dataSet$noun_length < 5,c("noun")], 15)', incorrect_msg =  "Make sure to print the first 15 values of 'noun' where noun_length < 5")
test_output_contains('dataSet[dataSet$Word %in% c("restricciones", "fotos", "olivas", "periodistas","cosechadoras"), c("noun_length")]',  incorrect_msg = "Make sure to extract the Length and the Freq of the words in the list")
test_output_contains('glimpse(dataSet)', incorrect_msg =  "Make sure to print a glimpse of the modified data.frame!")
success_msg("Great job!")
```

## 2. The normal distribution (recap)

- **ANALYZE**:
  - Are the `characters_before_noun` and `noun_length` variables distributed normally?
  - Why do you think so?

### 2.1 The `characters_before_noun` variable 

```{r ex="normal1_characters_before_noun", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="normal1_characters_before_noun", type="sample-code"}
# The data.frame dataSet is already in your workspace. 
# Calculate and compare the mean of characters_before_noun to the median of characters_before_noun

# Load the ggplot2 package

# Draw a qqplot with a qqline of the characters_before_noun variable

# Draw a density plot of the characters_before_noun variable

# Perform a Shapiro-Wilk test

# THINK: is the characters_before_noun variable distributed normally? You will find the correct answer on the Solution tab. 

```

```{r ex="normal1_characters_before_noun", type="solution"}
# The data.frame dataSet is already in your workspace. 
# Calculate and compare the mean of characters_before_noun to the median of characters_before_noun
mean(dataSet$characters_before_noun)
median(dataSet$characters_before_noun)
# Load the ggplot2 package
library(ggplot2)
# Draw a qqplot with a qqline of the characters_before_noun variable
qqnorm(dataSet$characters_before_noun)
qqline(dataSet$characters_before_noun)
# Draw a density plot of the characters_before_noun variable
ggplot(dataSet, aes(x=characters_before_noun)) + geom_line(stat="density") + geom_vline(aes(xintercept = mean(dataSet$characters_before_noun)), color="red")
# Perform a Shapiro-Wilk test
shapiro.test(dataSet$characters_before_noun)
# THINK: is the characters_before_noun variable distributed normally? You will find the correct answer on the Solution tab. 
# The correct answer is no: 
# - The mean and the median are not very closeby numerically
# - The dots do not follow the line in the qqplot
# - The mean is not in the middle of the distribution and the largest amount of values do not occur around the mean
# - The shapiro.test has a p < 0.05
```

```{r ex="normal1_characters_before_noun", type="sct"}
test_library_function("ggplot2", incorrect_msg = "Don't forget to load the ggplot2 package")
test_output_contains("mean(dataSet$characters_before_noun)",  incorrect_msg = "Make sure to calculate the mean")
test_output_contains("median(dataSet$characters_before_noun)",  incorrect_msg = "Make sure to calculate the median")
test_function("qqnorm", args = c("y"), incorrect_msg = "Make sure to draw a qqplot!")
test_function("qqline", args = c("y"), incorrect_msg = "Make sure to add a qqline to your qqplot!")
test_ggplot(index=1, all_fail_msg = "Computer says no. This plot is completely wrong", data_fail_msg = "Make sure you include the data in the ggplot call", aes_fail_msg = "Make sure you define the correct aesthetics (aes)", geom_fail_msg = "Make sure you define the correct plotting function (geom_)")
 test_output_contains("shapiro.test(dataSet$characters_before_noun)",  incorrect_msg = "Make sure to perform a Shapiro-Wilk test!")
success_msg("Great job!")
```

### 2.2 The `noun_length` variable

```{r ex="normal2", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="normal2", type="sample-code"}
# The data.frame dataSet is already in your workspace. 
# Calculate and compare the mean of noun_length to the median of noun_length

# Load the ggplot2 package

# Draw a qqplot with a qqline of the noun_length variable

# Draw a density plot of the noun_length variable

# Perform a Shapiro-Wilk test

# THINK: is the noun_length variable distributed normally? You will find the correct answer on the Solution tab. 

```

```{r ex="normal2", type="solution"}
# The data.frame dataSet is already in your workspace. 
# Calculate and compare the mean of noun_length to the median of noun_length
mean(dataSet$noun_length)
median(dataSet$noun_length)
# Load the ggplot2 package
library(ggplot2)
# Draw a qqplot with a qqline of the noun_length variable
qqnorm(dataSet$noun_length)
qqline(dataSet$noun_length)
# Draw a density plot of the noun_length variable
ggplot(dataSet, aes(x=noun_length)) + geom_line(stat="density") + geom_vline(aes(xintercept = mean(dataSet$noun_length)), color="red")
# Perform a Shapiro-Wilk test
shapiro.test(dataSet$noun_length)
# THINK: is the noun_length variable distributed normally? You will find the correct answer on the Solution tab. 
# The correct answer is no: 
# - The dots at the bottom and the top of the plot do not follow the line in the qqplot
# - The mean is not in the middle of the distribution and the distribution is not symmetrical
# - The shapiro.test has a p < 0.05, so we can assume that the data are not normally distributed
```

```{r ex="normal2", type="sct"}
test_library_function("ggplot2", incorrect_msg = "Don't forget to load the ggplot2 package")
test_output_contains("mean(dataSet$noun_length)",  incorrect_msg = "Make sure to calculate the mean")
test_output_contains("median(dataSet$noun_length)",  incorrect_msg = "Make sure to calculate the median")
test_function("qqnorm", args = c("y"), incorrect_msg = "Make sure to draw a qqplot!")
test_function("qqline", args = c("y"), incorrect_msg = "Make sure to add a qqline to your qqplot!")
test_ggplot(index=1, all_fail_msg = "Computer says no. This plot is completely wrong", data_fail_msg = "Make sure you include the data in the ggplot call", aes_fail_msg = "Make sure you define the correct aesthetics (aes)", geom_fail_msg = "Make sure you define the correct plotting function (geom_)")
test_output_contains("shapiro.test(dataSet$noun_length)",  incorrect_msg = "Make sure to perform a Shapiro-Wilk test!")
success_msg("Great job!")
```

## 3. Outliers 
- The previous excercises have shown that:
  - `noun_length` is mostly normally distributed, except for a few outliers in the right tail of the distribution, which draw the mean to the right. If we exclude these values, it will be distributed normally
  - `number_of_characters_before_noun` has a power-law distribution. We will need a `logarithmic` transformation to correct its distribution
  
### 3.1 Removing outliers from `noun_length`
```{r ex="noun_length_outliers", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="noun_length_outliers", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Add a new column to the dataSet called `noun_length_zscore`, in which you store z-scores for noun_length

# Overwrite `noun_length_zscore` so that it contains the absolute values of the z-scores

# Remove all outliers from dataSet. Remember that outliers are values with absolute z-scores of two or more

# Print a summary of the noun_length column

# Draw a qqplot of noun_length and add a qqline 

# ANALYZE: Does this fix the problem?
```

```{r ex="noun_length_outliers", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Add a new column to the dataSet called `noun_length_zscore`, in which you store z-scores for noun_length
dataSet$noun_length_zscore <- scale(dataSet$noun_length)

# Overwrite `noun_length_zscore` so that it contains the absolute values of the z-scores
dataSet$noun_length_zscore <- abs(dataSet$noun_length_zscore)
# Remove all outliers from dataSet. Remember that outliers are values with absolute z-scores of two or more
dataSet <- dataSet[dataSet$noun_length_zscore <= 2, ]

# Print a summary of the noun_length column
summary(dataSet$noun_length)
# Draw a qqplot of noun_length and add a qqline 
qqnorm(dataSet$noun_length)
qqline(dataSet$noun_length)

# ANALYZE: Does this fix the problem?
# The distribution is much closer to a normal distribution, but it is still far from ideal

```

```{r ex="noun_length_outliers", type="sct"}
test_output_contains("summary(dataSet$noun_length)", incorrect_msg = "Make sure to print a summary of the filtered noun_length column")
test_function("qqnorm", args = c("y"), incorrect_msg = "Make sure to draw a qqplot!")
test_function("qqline", args = c("y"), incorrect_msg = "Make sure to add a qqline to your qqplot!")
success_msg("Great job!")
```

## 4. Factors 
### 4.1 Factor levels

```{r ex="factors1", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="factors1", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Convert the column state to a factor

# Print its levels

```

```{r ex="factors1", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Convert the column state to a factor
dataSet$state <- as.factor(dataSet$state)
# Print its levels
levels(dataSet$state)
```

```{r ex="factors1", type="sct"}
 test_output_contains('levels(dataSet$state)',  incorrect_msg  = "Make sure to print the levels of the factor!")
success_msg("Great!")
```

### 4.2 Recoding factors
```{r ex="factors2", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv") 
```

```{r ex="factors2", type="sample-code"}
# The data.frame dataSet is already in your workspace. 
# Load the dplyr package

# Convert all character columns to factor

# The `state` column has quite some duplicates: 
# "Andalucía" and "Andalusia", "Aragon" and "Aragón", "Castile-La Mancha" and "Castilla-La-Mancha", "Castile and León" and "Castilla y León", "Catalonia" and "Cataluña", "Community of Madrid" and "Comunidad de Madrid", "Valencian Community" and "Comunidad Valenciana", "Basque Country" and "País Vasco"
# Recode all Spanish names to their English alternative

# Print the new levels of the `state` column

```

```{r ex="factors2", type="solution"}
# The data.frame dataSet is already in your workspace. 
# Load the dplyr package
library(dplyr)
# Convert all character columns to factor
dataSet <- mutate_if(dataSet, is.character, as.factor)
# The state column has quite some duplicates: 
# "Andalucía" and "Andalusia","Aragón" and "Aragon","Castilla-La-Mancha" and "Castile-La Mancha", "Castilla y León" and "Castile and León", "Cataluña" and "Catalonia", "Comunidad de Madrid" and "Community of Madrid", "Comunidad Valenciana" and "Valencian Community", "País Vasco" and "Basque Country"
# Recode all Spanish names to their English alternative
dataSet$state<-recode(dataSet$state, "Andalucía"="Andalusia" ,"Aragón" = "Aragon","Castilla-La-Mancha"= "Castile-La Mancha", "Castilla y León"="Castile-and-León", "Cataluña"="Catalonia", "Comunidad de Madrid"="Community of Madrid", "Comunidad Valenciana"="Valencian Community", "País Vasco"="Basque Country")
# Print the new levels of the `state` column
levels(dataSet$state)
```

```{r ex="factors2", type="sct"}
test_library_function("dplyr", incorrect_msg="Make sure to load the dplyr package!")
test_output_contains('levels(dataSet$state)',  incorrect_msg = "Make sure to print the new levels of the factor 'state'!")
success_msg("Great!")
```

### 4.3 Re-organizing factors

```{r ex="factors3", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="factors3", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Convert the column corpus to a factor

# Print its levels

# Relevel the corpus factor: its first value should be 'Twitter'

# Print its levels again

```

```{r ex="factors3", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Convert the column corpus to a factor
dataSet$corpus <- as.factor(dataSet$corpus)
# Print its levels
levels(dataSet$corpus)
# Relevel the corpus factor: its first value should be 'Twitter'
dataSet$corpus <- relevel(dataSet$corpus, ref="Twitter")
# Print its levels again
levels(dataSet$corpus)

```

```{r ex="factors3", type="sct"}
test_output_contains("levels(dataSet$corpus)", incorrect_msg = "Make sure to print the levels of the factor!")
success_msg("Great!")
```

## 5. Frequencies: counting values
### 5.1 Counting the `negation` variable 
```{r ex="counts_negation_freq", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="counts_negation_freq", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Convert the column negation to a factor

# Compute a table for the negation variable, store it in the variable 'negationTab'

# Convert 'negationTab' to a data.frame

# Print 'negationTab'


```

```{r ex="counts_negation_freq", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Convert the column negation to a factor
dataSet$negation<-as.factor(dataSet$negation)
# Compute a table for the negation variable, store it in the variable 'negationTab'
negationTab<-table(dataSet$negation)
# Convert 'negationTab' to a data.frame
negationTab<-as.data.frame(negationTab)
# Print 'negationTab'
negationTab
```

```{r ex="counts_negation_freq", type="sct"}
test_object("negationTab",incorrect_msg="Make sure to compute the table!")
test_output_contains("negationTab", incorrect_msg = "Make sure to print the table!")
success_msg("Great!")

```

### 5.2 Counting the `province` variable 
```{r ex="counts_province", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="counts_province", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Convert the column province to a factor

# Compute a table for the province variable, store it in the variable 'provinceTab'

# Convert 'provinceTab' to a data.frame

# Print 'provinceTab'


```

```{r ex="counts_province", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Convert the column province to a factor
dataSet$province<-as.factor(dataSet$province)
# Compute a table for the province variable, store it in the variable 'provinceTab'
provinceTab<-table(dataSet$province)
# Convert 'provinceTab' to a data.frame
provinceTab<-as.data.frame(provinceTab)
# Print 'provinceTab'
provinceTab
```

```{r ex="counts_province", type="sct"}
test_object("provinceTab", incorrect_msg="Make sure to compute the table!")
test_output_contains("provinceTab", incorrect_msg="Make sure to print the table!")
success_msg("Great!")
```

### 5.3 Counting the `Typical.Action.Chain.Pos` variable 
```{r ex="counts_Typical.Action.Chain.Pos", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="counts_Typical.Action.Chain.Pos", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Convert the column Typical.Action.Chain.Pos to a factor

# Compute a table for the Typical.Action.Chain.Pos variable, store it in the variable 'Typical.Action.Chain.PosTab'

# Convert 'Typical.Action.Chain.PosTab' to a data.frame

# Print 'Typical.Action.Chain.PosTab'


```

```{r ex="counts_Typical.Action.Chain.Pos", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Convert the column Typical.Action.Chain.Pos to a factor
dataSet$Typical.Action.Chain.Pos<-as.factor(dataSet$Typical.Action.Chain.Pos)
# Compute a table for the Typical.Action.Chain.Pos variable, store it in the variable 'Typical.Action.Chain.PosTab'
Typical.Action.Chain.PosTab<-table(dataSet$Typical.Action.Chain.Pos)
# Convert 'Typical.Action.Chain.PosTab' to a data.frame
Typical.Action.Chain.PosTab<-as.data.frame(Typical.Action.Chain.PosTab)
# Print 'Typical.Action.Chain.PosTab'
Typical.Action.Chain.PosTab
```

```{r ex="counts_Typical.Action.Chain.Pos", type="sct"}
test_object("Typical.Action.Chain.PosTab",incorrect_msg="Make sure to compute the table!")
test_output_contains("Typical.Action.Chain.PosTab", incorrect_msg="Make sure to print the table!")
success_msg("Great!")
```


## 6. Proportions
### 6.1 Proportions for the `Typical.Action.Chain.Pos` variable 
```{r ex="proportionsTypical.Action.Chain.Pos", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="proportionsTypical.Action.Chain.Pos", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Convert the column Typical.Action.Chain.Pos to a factor

# Compute a table for the Typical.Action.Chain.Pos variable, store it in the variable 'Typical.Action.Chain.PosTab'

# Compute proportions for that table

# Print 'Typical.Action.Chain.PosTab'


```

```{r ex="proportionsTypical.Action.Chain.Pos", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Convert the column Typical.Action.Chain.Pos to a factor
dataSet$Typical.Action.Chain.Pos<-as.factor(dataSet$Typical.Action.Chain.Pos)
# Compute a table for the Typical.Action.Chain.Pos variable, store it in the variable 'Typical.Action.Chain.PosTab'
Typical.Action.Chain.PosTab<-table(dataSet$Typical.Action.Chain.Pos)
# Compute proportions for that table
Typical.Action.Chain.PosTab<-prop.table(Typical.Action.Chain.PosTab)
# Print 'Typical.Action.Chain.PosTab'
Typical.Action.Chain.PosTab
```

```{r ex="proportionsTypical.Action.Chain.Pos", type="sct"}
test_object("Typical.Action.Chain.PosTab",incorrect_msg="Make sure to compute the table!")
test_output_contains('Typical.Action.Chain.PosTab',  incorrect_msg = "Make sure to compute proportions for the table!")
success_msg("Great!")
```

### 6.2 Proportions for the `corpus` variable 
```{r ex="proportionscorpus1", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="proportionscorpus1", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Convert the column corpus to a factor

# Compute a table for the corpus variable, store it in the variable 'corpusTab'

# Convert the corpusTab object to a data.frame 

# Compute proportions based on the Freq column of that data.frame. Store the proportions in a new column called 'prop'

# Print corpusTab

```

```{r ex="proportionscorpus1", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Convert the column corpus to a factor
dataSet$corpus<-as.factor(dataSet$corpus)
# Compute a table for the corpus variable, store it in the variable 'corpusTab'
corpusTab<-table(dataSet$corpus)
# Convert 'corpusTab' to a data.frame
corpusTab<-as.data.frame(corpusTab)
# Compute proportions based on the Freq column of that data.frame. Store the proportionsin a new column called 'prop'
corpusTab$prop<-corpusTab$Freq/sum(corpusTab$Freq, na.rm=TRUE)
# Print corpusTab
corpusTab
```

```{r ex="proportionscorpus1", type="sct"}
test_object("corpusTab",incorrect_msg="Make sure to compute the table!")
test_output_contains('corpusTab',  incorrect_msg="Make sure to compute proportions for the table!")
success_msg("Great!")
```

## 7. Bar plots 
### 7.1 Exploring the counts of the `corpus` variable (1/2)
- **ANALYZE**:
   - Which corpus provided the most examples?

```{r ex="freq1", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="freq1", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Convert the column corpus to a factor

# Print a table of the corpus factor 

```

```{r ex="freq1", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Convert the column corpus to a factor
dataSet$corpus<-as.factor(dataSet$corpus)

# Print a table of the corpus factor 
table(dataSet$corpus)
```

```{r ex="freq1", type="sct"}
test_output_contains("table(dataSet$corpus)", incorrect_msg = "Don't forget to print the table!")
success_msg("Great!")
```

### 7.1 Exploring the counts of the `corpus` variable (2/2)
```{r ex="freq2", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="freq2", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Convert the column corpus to a factor

# Load ggplot2

# Draw a basic bar chart of the corpus factor

```

```{r ex="freq2", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Convert the column corpus to a factor
dataSet$corpus<-as.factor(dataSet$corpus)
# Load ggplot2
library(ggplot2)
# Draw a basic bar chart of the corpus factor
ggplot(dataSet, aes(x=corpus)) + geom_bar()
```

```{r ex="freq2", type="sct"}
test_library_function("ggplot2", incorrect_msg = "Don't forget to load ggplot2")
test_ggplot(index = 1)
success_msg("Great!")
```

### 7.2 Exploring the counts of the `broad.regions` variable (1/2)
- **ANALYZE**:
  - Which broad.regions provided the most examples?

```{r ex="broad.regions_1", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="broad.regions_1", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Convert the column broad.regions to a factor

# Print a table of the broad.regions factor

```

```{r ex="broad.regions_1", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Convert the column broad.regions to a factor
dataSet$broad.regions<-as.factor(dataSet$broad.regions)

# Print a table of the broad.regions factor
table(dataSet$broad.regions)
```

```{r ex="broad.regions_1", type="sct"}
 test_output_contains('table(dataSet$broad.regions)',  incorrect_msg = "Make sure to print the table!")

success_msg("Great!")
```

### 7.2 Exploring the counts of the `broad.regions` variable (2/2)
```{r ex="broad.regions", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="broad.regions", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Convert the column broad.regions to a factor

# Load ggplot2

# Draw a pretty bar chart of the broad.regions factor: each region has its own fill and color, there is no legend title, the Y axis title is "Number of occurrences", the X axis title is "Large regions", the plot title is "Number of occurrences per region"

```

```{r ex="broad.regions", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Convert the column broad.regions to a factor
dataSet$broad.regions<-as.factor(dataSet$broad.regions)
# Load ggplot2
library(ggplot2)
# Draw a basic bar chart of the broad.regions factor
ggplot(dataSet, aes(x=broad.regions, fill=broad.regions, color=broad.regions)) + geom_bar() + theme(legend.title = element_blank()) + labs(x="Large regions", y="Number of occurrences", title="Number of occurrences per region")
```

```{r ex="broad.regions", type="sct"}
test_library_function("ggplot2")
test_ggplot(index=1, all_fail_msg = "Computer says no. This plot is completely wrong", data_fail_msg = "Make sure you include the data in the ggplot call", aes_fail_msg = "Make sure you define the correct aesthetics (aes)", geom_fail_msg = "Make sure you define the correct plotting function (geom_)")
success_msg("Great!")
```

### 7.3 Exploring the the counts of the `negation` variable 
- **ANALYZE**:
      - Do tokens with and without negation occur with equal frequency?
  
```{r ex="negation", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="negation", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Convert the column negation to a factor

# Print a table of the negation column

# Load ggplot2

# Draw a pretty bar chart of the negation factor: each value has its own fill and color, there is no legend title, the Y axis title is "Number of occurrences", the X axis title is "Absence/presence of negation", the plot title is "Number of occurrences per Absence/presence of negation"

```

```{r ex="negation", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Convert the column negation to a factor
dataSet$negation<-as.factor(dataSet$negation)
# Print a table of the negation column
table(dataSet$negation)
# Load ggplot2
library(ggplot2)
# Draw a basic bar chart of the negation factor
ggplot(dataSet, aes(x=negation, fill=negation, color=negation)) + geom_bar() + theme(legend.title = element_blank()) + labs(x="Large regions", y="Number of occurrences", title="Number of occurrences per region")
```

```{r ex="negation", type="sct"}

test_output_contains("table(dataSet$negation", incorrect_msg = "Make sure to print a table of negation")
test_library_function("ggplot2")
test_ggplot(index=1, all_fail_msg = "Computer says no. This plot is completely wrong", data_fail_msg = "Make sure you include the data in the ggplot call", aes_fail_msg = "Make sure you define the correct aesthetics (aes)", geom_fail_msg = "Make sure you define the correct plotting function (geom_)")

success_msg("Great!")
```

### 7.4 Exploring the proportions of the `corpus` variable (1/2)
- **ANALYZE**:
      - Which corpus provided the most examples?

```{r ex="freq1_prop", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="freq1_prop", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Convert the column corpus to a factor

# Print a table of the proportions of the corpus factor 

```

```{r ex="freq1_prop", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Convert the column corpus to a factor
dataSet$corpus<-as.factor(dataSet$corpus)

# Print a table of the proportions of the corpus factor 
prop.table(table(dataSet$corpus))
```

```{r ex="freq1_prop", type="sct"}

 test_output_contains('prop.table(table(dataSet$corpus))',  incorrect_msg = "Make sure to print the table!")

success_msg("Great!")
```

### 7.4 Exploring the proportions of the `corpus` variable (2/2)
```{r ex="prop2", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="prop2", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Convert the column corpus to a factor

# Load ggplot2

# Draw a basic bar chart of the proportions of the corpus factor

```

```{r ex="prop2", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Convert the column corpus to a factor
dataSet$corpus<-as.factor(dataSet$corpus)
# Load ggplot2
library(ggplot2)
# Draw a basic bar chart of the proportions of the corpus factor
ggplot(dataSet, aes(x=corpus)) + geom_bar(aes(y=..count../sum(..count..)))
```

```{r ex="prop2", type="sct"}
test_library_function("ggplot2")
test_ggplot(index=1, all_fail_msg = "Computer says no. This plot is completely wrong", data_fail_msg = "Make sure you include the data in the ggplot call", aes_fail_msg = "Make sure you define the correct aesthetics (aes)", geom_fail_msg = "Make sure you define the correct plotting function (geom_)")

success_msg("Great!")
```

### 7.5 Exploring the proportions of the `broad.regions` variable (1/2)
- **ANALYZE**:
      - Which broad.regions provided the most examples?

```{r ex="broad.regions_1", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="broad.regions_1", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Convert the column broad.regions to a factor

# Print a table of the proportions of the broad.regions factor 

```

```{r ex="broad.regions_1", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Convert the column broad.regions to a factor
dataSet$broad.regions<-as.factor(dataSet$broad.regions)

# Print a table of the proportions of the broad.regions factor 
table(dataSet$broad.regions)
```

```{r ex="broad.regions_1", type="sct"}
 test_output_contains('table(dataSet$broad.regions)',  incorrect_msg = "Make sure to print the table!")

success_msg("Great!")
```

### 7.5 Exploring the proportions of the `broad.regions` variable (2/2)
```{r ex="broad.regions_prop", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="broad.regions_prop", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Convert the column broad.regions to a factor

# Load ggplot2

# Draw a pretty bar chart of the proportions of the broad.regions factor: each region has its own fill and color, there is no legend title, the Y axis title is "Number of occurrences", the X axis title is "Large regions", the plot title is "Number of occurrences per region"

```

```{r ex="broad.regions_prop", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Convert the column broad.regions to a factor
dataSet$broad.regions<-as.factor(dataSet$broad.regions)
# Load ggplot2
library(ggplot2)
# Draw a pretty bar chart of the proportions of the broad.regions factor: each region has its own fill and color, there is no legend title, the Y axis title is "Number of occurrences", the X axis title is "Large regions", the plot title is "Number of occurrences per region"
ggplot(dataSet, aes(x=broad.regions, fill=broad.regions, color=broad.regions)) + geom_bar(aes(y=..count../sum(..count..))) + theme(legend.title = element_blank()) + labs(x="Large regions", y="Number of occurrences", title="Number of occurrences per region")
```

```{r ex="broad.regions_prop", type="sct"}
test_library_function("ggplot2")
test_ggplot(index=1, all_fail_msg = "Computer says no. This plot is completely wrong", data_fail_msg = "Make sure you include the data in the ggplot call", aes_fail_msg = "Make sure you define the correct aesthetics (aes)", geom_fail_msg = "Make sure you define the correct plotting function (geom_)")
success_msg("Great!")
```

### 7.6 Exploring the the proportions of the `negation` variable 
- **ANALYZE**:
        - Do tokens with and without negation occur with equal frequency?

```{r ex="negation_prop", type="pre-exercise-code"}
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
library(readr)
dataSet <- read_csv("http://www.jeroenclaes.be/statistics_for_linguistics/datasets/class3_claes_2017.csv")
```

```{r ex="negation_prop", type="sample-code"}
# The data.frame dataSet is already in your workspace. 

# Convert the column negation to a factor

# Print a table of the negation column

# Load ggplot2

# Draw a pretty bar chart of the proportions of the negation factor: each value has its own fill and color, there is no legend title, the Y axis title is "Number of occurrences", the X axis title is "Absence/presence of negation", the plot title is "Number of occurrences per Absence/presence of negation"

```

```{r ex="negation_prop", type="solution"}
# The data.frame dataSet is already in your workspace. 

# Convert the column negation to a factor
dataSet$negation<-as.factor(dataSet$negation)
# Print a table of the negation column
table(dataSet$negation)
# Load ggplot2
library(ggplot2)
# Draw a pretty bar chart of the proportions of the negation factor: each value has its own fill and color, there is no legend title, the Y axis title is "Number of occurrences", the X axis title is "Absence/presence of negation", the plot title is "Number of occurrences per Absence/presence of negation"
ggplot(dataSet, aes(x=negation, fill=negation, color=negation)) + geom_bar(aes(y=..count../sum(..count..))) + theme(legend.title = element_blank()) + labs(x="Large regions", y="Number of occurrences", title="Number of occurrences per region")
```

```{r ex="negation_prop", type="sct"}
test_output_contains("table(dataSet$negation)", "Remember to print a table of negation")
test_library_function("ggplot2")
test_ggplot(index=1, all_fail_msg = "Computer says no. This plot is completely wrong", data_fail_msg = "Make sure you include the data in the ggplot call", aes_fail_msg = "Make sure you define the correct aesthetics (aes)", geom_fail_msg = "Make sure you define the correct plotting function (geom_)")

success_msg("Great!")
```
